<!DOCTYPE html>
<html lang='en-US'>
	<head>
		<title>Generate Timetable</title>
		<script type="text/javascript">
			let morningShift = [];
			let afternoonShift = [];
                        let thursday = [];
			thursday.name = "Thu"
			let friday = [];
			friday.name = "Fri";
			let saturday = [];
			saturday.name = "Sat";
			let sunday = [];
			sunday.name = "Sun";

			function addName(form, div){
				let agent = form.names.value;
                        	let offDay = form.off_day.value;
				
				if (form == document.formA){
					morningShift.push(agent);
				} else {
					afternoonShift.push(agent);
				}
				
				let el = document.createElement("p");
                        	el.innerText = agent;
				div.appendChild(el);

				if (offDay == thursday.name){
					thursday.push(agent);
				} else if (offDay == friday.name){
					friday.push(agent);
				} else if (offDay == saturday.name){
					saturday.push(agent);
				} else if (offDay == sunday.name){
					sunday.push(agent);
				} else {
					document.body.append(
						"Please select off day.");
				}
			}
			
			function removeName(form, div){
				let agent = form.names.value;
				if (form == document.formA){
					morningShift.pop(agent);
				} else {
					afternoonShift.pop(agent);
				}
				thursday.pop(agent);
				friday.pop(agent);
				saturday.pop(agent);
				sunday.pop(agent);
				let el = document.getElementsByTagName("p");
				for (var i = 0; i < el.length; i++){
					if (el[i].innerText == agent){
						div.removeChild(el[i]);
					}
				}
			}

			function generateTimetable(morningShift, afternoonShift){
				let timetable = window.open(
					'', 'Timetable', 'toolbar=no,status=no');
				let weekday = ['MONDAY', 'TUESDAY', 'WEDNESDAY',
					'THURSDAY', 'FRIDAY', 'SATURDAY', 'SUNDAY']
				const tbl = document.createElement('table');
				const tblBody = document.createElement('tbody');
				let row = document.createElement('tr');
				for (let i = 0; i < weekday.length; i++){
					let cell = document.createElement('td');
					let cellText = document.createTextNode(weekday[i]);
					cell.appendChild(cellText);
					row.appendChild(cell);
				}
				tblBody.appendChild(row);
				
				let row1 = document.createElement('tr');
				let cell1 = document.createElement('td');
				let cell2 = document.createElement('td');
				for (let i = 0; i < morningShift.length; i++){
					let cellText = document.createTextNode(morningShift[i]);
					let el = document.createElement('p');
					cell1.appendChild(cellText);
					cell1.appendChild(el);
				}
				row1.appendChild(cell1);
				
				for (let j = 0; j < afternoonShift.length; j++){
                                        let cellText = document.createTextNode(afternoonShift[j]);
					let el = document.createElement('p');
                                        cell2.appendChild(cellText);
                                        cell2.appendChild(el);
                                }
				row1.appendChild(cell2);

				tblBody.appendChild(row1);

				tbl.appendChild(tblBody);
				tbl.setAttribute('border', '2');
				tbl.setAttribute('cellpadding', '5');
				tbl.setAttribute('cellspacing', '10%');
				tbl.setAttribute('width', '100%');
				timetable.document.body.appendChild(tbl);

			}
		</script>
	</head>
	<body>
		<h3>A simple page for generating timetables</h3>
		<hr/>
		<div id="morning" style="float:left; margin-left:3%">
			<form name="formA" method="POST" action="">
				<p>Morning shift names: {{ form1.names }}</p>
				<p>
				Select off day: {{ form1.off_day }}</p>
			</form>
			<button type="button" style="margin-left:60%"
				onclick="addName(document.formA, 
				document.getElementById('morning'));">ADD</button>
			<button type="button" style="margin-left:3%" 
					      onclick="removeName(document.formA,
					      document.getElementById('morning'));">
				REMOVE</button>

		</div>
		<div style="margin-left:10%; margin-top:5%; float:left">
			<button type="button" style="font-weight:bold" onclick=
				"generateTimetable(morningShift, afternoonShift);">
			Click here to generate the Timetable</button>
		</div>
		<div id="afternoon" style="float:right; margin-right:10%;">
                        <form name="formB" method="POST" action="">
                                <p>Afternoon shift names: {{ form2.names }}</p>
                                <p>Select off day: {{ form2.off_day }}</p>
                        </form>
                        <button type="button" style="margin-left:60%"
				onclick="addName(document.formB, 
				document.getElementById('afternoon'));">ADD</button>
                        <button type="button" style="margin-left:3%" 
					      onclick="removeName(document.formB, 
					      document.getElementById('afternoon'));">
                                REMOVE</button>

                </div>

	</body>
</html>
